alwaysApply: true
---
# ğŸŒŸ Cursor Rules â€“ Plone 6 Classic ğŸŒŸ

# ================================
# ğŸ“¦ Estructura de Paquetes
# ================================

## Paquete `core` (funcional)
src/
â””â”€â”€ my.package.core/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ config/ ğŸ”§
    â”œâ”€â”€ browser/
    â”‚   â”œâ”€â”€ templates/ ğŸ“
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ content/ ğŸ—‚
    â”œâ”€â”€ patches/ âš ï¸
    â”œâ”€â”€ profiles/
    â”‚   â”œâ”€â”€ default/ âœ…
    â”‚   â”‚   â”œâ”€â”€ metadata.xml
    â”‚   â”‚   â”œâ”€â”€ types.xml
    â”‚   â”‚   â”œâ”€â”€ registry.xml
    â”‚   â”‚   â”œâ”€â”€ catalog.xml
    â”‚   â”‚   â””â”€â”€ ...
    â”‚   â””â”€â”€ uninstall/ â™»ï¸
    â”œâ”€â”€ locales/ ğŸŒ
    â”œâ”€â”€ tests/
    â”‚   â”œâ”€â”€ unit/ ğŸ§ª
    â”‚   â”œâ”€â”€ integration/ ğŸ”—
    â”‚   â””â”€â”€ functional/ âš™ï¸
    â”œâ”€â”€ configure.zcml
    â”œâ”€â”€ overrides.zcml
    â”œâ”€â”€ patches.zcml
    â””â”€â”€ version.txt ğŸ“Œ

## Paquete `theme` (presentaciÃ³n)
src/
â””â”€â”€ my.package.theme/
    â”œâ”€â”€ __init__.py
    â”œâ”€â”€ browser/
    â”‚   â”œâ”€â”€ templates/ ğŸ“
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ profiles/
    â”‚   â””â”€â”€ default/
    â”‚       â”œâ”€â”€ metadata.xml
    â”‚       â””â”€â”€ theme/
    â”‚           â”œâ”€â”€ rules.xml ğŸ“œ
    â”‚           â””â”€â”€ manifest.cfg
    â”œâ”€â”€ resources/ ğŸ–Œ
    â”‚   â”œâ”€â”€ css/
    â”‚   â”œâ”€â”€ js/
    â”‚   â”œâ”€â”€ images/
    â”‚   â””â”€â”€ ...
    â”œâ”€â”€ static/ ğŸ“‚
    â”œâ”€â”€ locales/ ğŸŒ
    â”œâ”€â”€ theme.zip
    â”œâ”€â”€ configure.zcml
    â”œâ”€â”€ viewlets.zcml
    â””â”€â”€ version.txt ğŸ“Œ

# ================================
# ğŸ–‹ Convenciones de CÃ³digo
# ================================

- `snake_case` para funciones/variables, `CamelCase` para clases ğŸ
- PEP 8 ğŸ“
- Docstrings con estilo Google o NumPy ğŸ“–
- Constantes en `config/`
- Evitar `import *`, usar importaciones explÃ­citas ğŸ”
- AÃ±adir `type hints` siempre
- Evitar estado global o mutable âš ï¸

# ================================
# âš™ï¸ Archivos de ConfiguraciÃ³n
# ================================

- Declarar componentes en `configure.zcml`
- Usar `profiles/default/` y `profiles/uninstall/`
- XML: `types.xml`, `registry.xml`, `rolemap.xml`, `catalog.xml`
- Registrar bundles JS/CSS en `registry.xml`

# ================================
# ğŸ§© Sobreescrituras y Monkey Patches
# ================================

- `overrides.zcml` para sobreescrituras
- `patches.zcml` + carpeta `patches/` para monkey patches âš ï¸
- Documentar propÃ³sito, alcance y riesgo de cada patch
- Preferir adaptadores o subscribers
- Evitar tocar core crÃ­tico de Plone ğŸ”

# ================================
# ğŸ–¼ Plantillas
# ================================

- Guardar en `templates/`
- TAL/ZPT, evitar lÃ³gica compleja
- Compatible con `viewlets` y `portlets`
- Separar presentaciÃ³n de lÃ³gica de negocio

# ================================
# ğŸŒ Recursos EstÃ¡ticos
# ================================

- `resources/` â†’ assets gestionados por `plone.staticresources`
- `static/` â†’ archivos no gestionados dinÃ¡micamente
- JS compatible Mockup / PatternsLib
- Registrar bundles en `registry.xml`
- Diferenciar recursos core vs theme

# ================================
# ğŸ Principios de Desarrollo Python
# ================================

- Funciones puras (`def`) sobre clases si no hay estado
- PatrÃ³n RORO: recibe objeto â†’ devuelve objeto
- Modularidad y DRY
- Early return > if/else anidado
- Evitar estado global
- Docstrings + type hints
- Manejar errores explÃ­citamente

# ================================
# ğŸ§  CachÃ©
# ================================

- Evitar `@ram.cache` con mÃºltiples ZC âš ï¸
- Alternativa: pasar `request` y gestionar invalidaciones con frontend/eventos
- Ejemplo: <https://github.com/UPCnet/genweb6.serveistic/commit/aa40ec2960bae6863057c4f070190aa4cc842be6>
- `plone.memoize`: usar con precauciÃ³n y scope correcto (`request` vs `instance`)

# ================================
# ğŸ§ª Pruebas
# ================================

- `unittest` o `pytest` con `plone.testing`
- Agrupar por funcionalidad
- Carpetas: `tests/unit/`, `tests/integration/`, `tests/functional/`
- `@layer` para aislar tests funcionales, integraciÃ³n, etc.

# ================================
# ğŸ“š DocumentaciÃ³n
# ================================

- Guardar en `docs/` o `README.rst`
- Incluir instalaciÃ³n, desarrollo, tests
- Explicar dependencias y estructura del paquete

# ================================
# ğŸ”— Dependencias
# ================================

- Declarar en `setup.py` (`install_requires`, `extras_require`)
- Compatibilidad con Plone objetivo
- `constraints.txt` opcional para CI/CD

# ================================
# ğŸ“ Versiones
# ================================

- `version.txt` formato `X.Y.Z`
- Alinear versiÃ³n con core/theme/dependencies

# ================================
# ğŸ“œ Licencias
# ================================

- Incluir `LICENSE`
- Declarar en `setup.py`

# ================================
# ğŸ’¡ Buenas PrÃ¡cticas Plone
# ================================

- DocumentaciÃ³n oficial: <https://6.docs.plone.org/>
- Plone Training: <https://training.plone.org/>
- Separar core vs theme
- Usar perfiles de instalaciÃ³n/desinstalaciÃ³n
- Evitar manipulaciÃ³n directa de contenido; usar API/adaptadores
- Seguir naming conventions de tipos y behaviors
